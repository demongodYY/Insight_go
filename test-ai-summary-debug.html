<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ€»ç»“åŠŸèƒ½è°ƒè¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        .title {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 16px;
            color: #6b7280;
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .debug-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 15px;
        }
        .debug-content {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .test-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 500;
        }
        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
        .mock-data {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .mock-data h4 {
            margin: 0 0 10px 0;
            color: #92400e;
        }
        .mock-data pre {
            margin: 0;
            background: #1f2937;
            color: #f9fafb;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ¤– AIæ€»ç»“åŠŸèƒ½è°ƒè¯•é¡µé¢</h1>
            <p class="subtitle">ç”¨äºè°ƒè¯•å’Œæµ‹è¯•AIè‡ªåŠ¨æ€»ç»“åŠŸèƒ½çš„å„ä¸ªç»„ä»¶</p>
        </div>

        <div class="debug-section">
            <h3 class="debug-title">ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
            <div id="debug-info">
                <div class="status info">ç­‰å¾…å¼€å§‹è°ƒè¯•...</div>
            </div>
        </div>

        <div class="debug-section">
            <h3 class="debug-title">ğŸ§ª æµ‹è¯•åŠŸèƒ½</h3>
            <button class="test-button" onclick="testDataExtraction()">æµ‹è¯•æ•°æ®æå–</button>
            <button class="test-button" onclick="testCardRendering()">æµ‹è¯•å¡ç‰‡æ¸²æŸ“</button>
            <button class="test-button" onclick="testMockData()">æµ‹è¯•æ¨¡æ‹Ÿæ•°æ®</button>
            <button class="test-button" onclick="clearDebug()">æ¸…ç©ºè°ƒè¯•ä¿¡æ¯</button>
        </div>

        <div class="debug-section">
            <h3 class="debug-title">ğŸ“Š æ¨¡æ‹Ÿæ•°æ®</h3>
            <div class="mock-data">
                <h4>AIè¿”å›çš„æ ‡å‡†æ•°æ®ç»“æ„ï¼š</h4>
                <pre>{
  "cards": [
    {
      "title": "Pythonå¼‚å¸¸å¤„ç†",
      "summary": "Pythonå¼‚å¸¸å¤„ç†æ˜¯ç¼–ç¨‹ä¸­çš„é‡è¦æ¦‚å¿µï¼Œä½¿ç”¨try-exceptè¯­å¥å¯ä»¥æ•è·å’Œå¤„ç†ç¨‹åºè¿è¡Œæ—¶çš„é”™è¯¯ã€‚é€šè¿‡åˆç†çš„å¼‚å¸¸å¤„ç†ï¼Œå¯ä»¥æé«˜ç¨‹åºçš„å¥å£®æ€§å’Œç”¨æˆ·ä½“éªŒã€‚",
      "tags": ["Python", "å¼‚å¸¸å¤„ç†", "ç¼–ç¨‹"]
    },
    {
      "title": "å¼‚æ­¥ç¼–ç¨‹åŸºç¡€",
      "summary": "å¼‚æ­¥ç¼–ç¨‹å…è®¸ç¨‹åºåœ¨ç­‰å¾…I/Oæ“ä½œå®Œæˆæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œæé«˜ç¨‹åºçš„æ•ˆç‡ã€‚åœ¨Pythonä¸­ï¼Œå¯ä»¥ä½¿ç”¨async/awaitè¯­æ³•å®ç°å¼‚æ­¥ç¼–ç¨‹ã€‚",
      "tags": ["å¼‚æ­¥ç¼–ç¨‹", "Python", "æ€§èƒ½ä¼˜åŒ–"]
    }
  ]
}</pre>
            </div>
        </div>

        <div class="debug-section">
            <h3 class="debug-title">ğŸ¯ é¢„æœŸç»“æœ</h3>
            <div id="expected-results">
                <div class="status info">ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹ç»“æœ...</div>
            </div>
        </div>
    </div>

    <script>
        let debugLog = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            debugLog.push({ message: logEntry, type });
            
            const debugInfo = document.getElementById('debug-info');
            const statusDiv = document.createElement('div');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = logEntry;
            debugInfo.appendChild(statusDiv);
            
            console.log(logEntry);
        }
        
        function clearDebug() {
            debugLog = [];
            document.getElementById('debug-info').innerHTML = '<div class="status info">è°ƒè¯•ä¿¡æ¯å·²æ¸…ç©º</div>';
            document.getElementById('expected-results').innerHTML = '<div class="status info">ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹ç»“æœ...</div>';
        }
        
        function testDataExtraction() {
            log('å¼€å§‹æµ‹è¯•æ•°æ®æå–åŠŸèƒ½...', 'info');
            
            // æ¨¡æ‹Ÿå¯¹è¯æ•°æ®
            const mockConversation = {
                source: 'DeepSeek',
                url: 'https://chat.deepseek.com/chat/123',
                messages: [
                    {
                        role: 'user',
                        text: 'è¯·ä»‹ç»ä¸€ä¸‹Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶'
                    },
                    {
                        role: 'assistant',
                        text: 'Pythonå¼‚å¸¸å¤„ç†ä½¿ç”¨try-exceptè¯­å¥ï¼Œå¯ä»¥æ•è·å’Œå¤„ç†ç¨‹åºè¿è¡Œæ—¶çš„é”™è¯¯...'
                    }
                ]
            };
            
            log(`æå–åˆ° ${mockConversation.messages.length} æ¡å¯¹è¯æ¶ˆæ¯`, 'success');
            log(`å¯¹è¯æ¥æº: ${mockConversation.source}`, 'info');
            log(`å¯¹è¯URL: ${mockConversation.url}`, 'info');
            
            mockConversation.messages.forEach((msg, index) => {
                log(`æ¶ˆæ¯${index + 1}: ${msg.role} - ${msg.text.substring(0, 50)}...`, 'info');
            });
            
            return mockConversation;
        }
        
        function testCardRendering() {
            log('å¼€å§‹æµ‹è¯•å¡ç‰‡æ¸²æŸ“åŠŸèƒ½...', 'info');
            
            // æ¨¡æ‹ŸAIè¿”å›çš„çŸ¥è¯†å¡ç‰‡æ•°æ®
            const mockCards = [
                {
                    title: 'Pythonå¼‚å¸¸å¤„ç†',
                    summary: 'Pythonå¼‚å¸¸å¤„ç†æ˜¯ç¼–ç¨‹ä¸­çš„é‡è¦æ¦‚å¿µï¼Œä½¿ç”¨try-exceptè¯­å¥å¯ä»¥æ•è·å’Œå¤„ç†ç¨‹åºè¿è¡Œæ—¶çš„é”™è¯¯ã€‚é€šè¿‡åˆç†çš„å¼‚å¸¸å¤„ç†ï¼Œå¯ä»¥æé«˜ç¨‹åºçš„å¥å£®æ€§å’Œç”¨æˆ·ä½“éªŒã€‚',
                    tags: ['Python', 'å¼‚å¸¸å¤„ç†', 'ç¼–ç¨‹']
                },
                {
                    title: 'å¼‚æ­¥ç¼–ç¨‹åŸºç¡€',
                    summary: 'å¼‚æ­¥ç¼–ç¨‹å…è®¸ç¨‹åºåœ¨ç­‰å¾…I/Oæ“ä½œå®Œæˆæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œæé«˜ç¨‹åºçš„æ•ˆç‡ã€‚åœ¨Pythonä¸­ï¼Œå¯ä»¥ä½¿ç”¨async/awaitè¯­æ³•å®ç°å¼‚æ­¥ç¼–ç¨‹ã€‚',
                    tags: ['å¼‚æ­¥ç¼–ç¨‹', 'Python', 'æ€§èƒ½ä¼˜åŒ–']
                }
            ];
            
            log(`å‡†å¤‡æ¸²æŸ“ ${mockCards.length} å¼ çŸ¥è¯†å¡ç‰‡`, 'info');
            
            // æµ‹è¯•å­—æ®µæå–é€»è¾‘
            mockCards.forEach((card, index) => {
                log(`å¡ç‰‡${index + 1}æ•°æ®éªŒè¯:`, 'info');
                log(`  - æ ‡é¢˜: ${card.title}`, 'info');
                log(`  - æ‘˜è¦: ${card.summary.substring(0, 50)}...`, 'info');
                log(`  - æ ‡ç­¾: ${card.tags.join(', ')}`, 'info');
                
                // æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
                if (!card.title || !card.summary) {
                    log(`  âš ï¸ å¡ç‰‡${index + 1}æ•°æ®ä¸å®Œæ•´`, 'error');
                } else {
                    log(`  âœ… å¡ç‰‡${index + 1}æ•°æ®å®Œæ•´`, 'success');
                }
            });
            
            // æ¨¡æ‹Ÿæ¸²æŸ“ç»“æœ
            const renderResult = mockCards.map(card => ({
                title: card.title || 'æœªå‘½åå¡ç‰‡',
                body: card.summary || 'æ— å†…å®¹',
                tags: Array.isArray(card.tags) ? card.tags : [],
                needExpand: (card.summary || '').length > 80
            }));
            
            log('æ¸²æŸ“ç»“æœ:', 'info');
            renderResult.forEach((result, index) => {
                log(`  å¡ç‰‡${index + 1}: æ ‡é¢˜="${result.title}", æ­£æ–‡é•¿åº¦=${result.body.length}, éœ€è¦å±•å¼€=${result.needExpand}`, 'info');
            });
            
            return renderResult;
        }
        
        function testMockData() {
            log('å¼€å§‹æµ‹è¯•æ¨¡æ‹Ÿæ•°æ®...', 'info');
            
            const conversation = testDataExtraction();
            const cards = testCardRendering();
            
            // æ¨¡æ‹Ÿå®Œæ•´çš„AIæ€»ç»“æµç¨‹
            log('æ¨¡æ‹ŸAIæ€»ç»“æµç¨‹:', 'info');
            log('1. æå–å¯¹è¯å†…å®¹ âœ…', 'success');
            log('2. è°ƒç”¨AIæœåŠ¡ âœ…', 'success');
            log('3. è§£æè¿”å›ç»“æœ âœ…', 'success');
            log('4. æ¸²æŸ“çŸ¥è¯†å¡ç‰‡ âœ…', 'success');
            
            // æ˜¾ç¤ºé¢„æœŸç»“æœ
            const expectedResults = document.getElementById('expected-results');
            expectedResults.innerHTML = `
                <div class="status success">âœ… æµ‹è¯•å®Œæˆï¼</div>
                <div class="mock-data">
                    <h4>é¢„æœŸæ¸²æŸ“ç»“æœï¼š</h4>
                    <pre>${JSON.stringify(cards, null, 2)}</pre>
                </div>
            `;
            
            log('æ‰€æœ‰æµ‹è¯•å®Œæˆï¼', 'success');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('è°ƒè¯•é¡µé¢å·²åŠ è½½å®Œæˆ', 'success');
            log('å¯ä»¥å¼€å§‹æµ‹è¯•AIæ€»ç»“åŠŸèƒ½çš„å„ä¸ªç»„ä»¶', 'info');
        });
    </script>
</body>
</html>
